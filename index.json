[{"content":"Repo: https://github.com/MerrimanLab/QTL_pipelines\nThis pipeline runs a co-localisation analysis using a list of key SNPs, a GWAS results file, and the GTEx dataset.\nbash cis_eqtl_pipeline.sh my_gwas.txt my_snplist.txt 1000000 ","description":"","id":0,"section":"docs","tags":[],"title":"cis-eQTL","uri":"https://merrimanlab.github.io/docs/eqtl/cis-eqtl/"},{"content":"Include name, location on server, link to source and when downloaded/created\nSummary    Resource Version Created/Downloaded     1000 Genomes Project Phase3 September 2014/March 2017   Human Reference Sequence GRCh37 (build 37/hg19) tbc   dbSNP 137 tbc   GATK Resource Bundle b.37 tbc   1KGP Impute Panel Phase3 October 2014    Hosted shiny apps    Name URL     Merriman GTEx eQTL browser http://biochemcompute.otago.ac.nz:3838/mik-apps/QTLBrowser/    Web Resources    Name Genome Build Website     ensembl genome browser GRCh37 http://grch37.ensembl.org/index.html   ensembl genome browser GRCh38 http://ensembl.org/index.html   ensembl ftp  ftp://ftp.ensembl.org/pub/   UCSC genome browser GRCh38 https://genome.ucsc.edu/index.html   UK10K genome browser GRCh37 http://www.uk10k.org/dalliance.html   dbSNP GRCh37/38 http://www.ncbi.nlm.nih.gov/projects/SNP/index.html   LocusZoom  http://locuszoom.sph.umich.edu/locuszoom/   eQTL browser  http://www.ncbi.nlm.nih.gov/projects/gap/eqtl/index.cgi   GTEx Portal  http://www.gtexportal.org/home/   Disease Variant Store  https://rvs.u.hpc.mssm.edu/divas/   DAVID  https://david.ncifcrf.gov/home.jsp   Exome Variant Server  http://evs.gs.washington.edu/EVS/   1000 Genomes Project GRCh37 http://1000genomes.org/   1000 Genomes Project ftp  http://ftp.1000genomes.ebi.ac.uk/vol1/ftp/   Sanger Impute Server  https://imputation.sanger.ac.uk/   HapMap Project GRCh36 http://hapmap.ncbi.nlm.nih.gov/   SHEsis  http://analysis.bio-x.cn/myAnalysis.php   SNAP proxy  https://www.broadinstitute.org/mpg/snap/ldsearch.php   Strand files  http://www.well.ox.ac.uk/~wrayner/strand/   Genome Reference Consortium  http://www.ncbi.nlm.nih.gov/projects/genome/assembly/grc/   NCBI Genome ReMapper  http://www.ncbi.nlm.nih.gov/genome/tools/remap#   GWAS Catalog  www.ebi.ac.uk/gwas/   GWAS Central  www.gwascentral.org   UK Biobank  http://biobank.ctsu.ox.ac.uk/crystal/   UK Biobank ICD explorer  http://risteys.broadinstitute.org    1000 Genomes Project Phase 3 release from September 2014 location: /Volumes/archive/merrimanlab/reference_files/VCF/1000Genomes_vcf_files/Phase3_Sept2014\nPhase 3 release from March 2017 location: /Volumes/archive/merrimanlab/reference_files/VCF/1000Genomes_vcf_files/Phase3_March2017\nBoth are in GRCh37 coordinates.\nImpute2 reference panel GRCh37 coordinates\nhttps://mathgen.stats.ox.ac.uk/impute/1000GP_Phase3.html\nHuman Reference Sequence GRCh37 Decoy reference\nDownloaded 5 Aug 2014\nurl: ftp://ftp.1000genomes.ebi.ac.uk:21/vol1/ftp/technical/reference/phase2_reference_assembly_sequence/hs37d5.fa.gz\nLocation: /Volumes/archive/merrimanlab/reference_files/FASTA/hs37d5/hsd37d5.fa\ndbSNP dbSNP 151 is available in both GRCh37 and GRCh38 genome builds as a vcf at /Volumes/archive/merrimanlab/reference_files/VCF/dbSNP_reference/dbsnp151/\nGRCh37 is from 2018-04-23\nGRCh38/Hg38 is from 2018-04-18\nGATK Resource Bundle Crucial resource for running the GATK.\nMore information: http://gatkforums.broadinstitute.org/discussion/1213/whats-in-the-resource-bundle-and-how-can-i-get-it\nAncestral allele Downloaded 6 Aug 2014\nurl: ftp://ftp.ensembl.org/pub/release-66/fasta/ancestral_alleles/homo_sapiens_ancestor_GRCh37_e66.tar.bz\n/Volumes/archive/merrimanlab/reference_files/Ancestral_Alleles/homo_sapiens_ancestor_GRCh37_e65/\n","description":"","id":1,"section":"quickref","tags":[],"title":"Reference Resources","uri":"https://merrimanlab.github.io/quickref/reference-resources/"},{"content":"Current training resources for the lab\nNovice/Intro: The Carpentries Software Capentry  Shell R Git/Github SQL  Data Carpentry  Data analysis and visualisation in R Best practice spreadsheets for use later in R  Custom made Merriman Lab R tutorial\n Intro lesson Stats lesson Programming lesson ggplot2 lesson  Additional: R  dplyr ggplot2 RMySQL Rmarkdown  ","description":"","id":2,"section":"quickref","tags":["R"],"title":"Training Resources","uri":"https://merrimanlab.github.io/quickref/training-resources/"},{"content":"hello\n","description":"","id":3,"section":"post","tags":[],"title":"new","uri":"https://merrimanlab.github.io/post/new/"},{"content":"This guide provides a comprehensive set of steps for the manual curation of genotype calls within Genome Studio. Genome Studio\u0026rsquo;s automatic clustering algorithms are reported to be accurate for ~ 99 % of SNPs. The other ~ 1 % need to be manually reviewed. This guide offers a consistent and logical approach and is aimed at reducing the workload where possible. The steps here are a combination of those published by Guo et al. (2014) and Illumina (2016).\nIn our experience, the steps outlined by Illumina (2016) provide a more logical and complete framework for the curation of autosomal SNPs, than those published by Guo et al. (2014). However, Guo et al. (2014) include more detailed instructions for the curation of haploid SNPs and also include post-quality control steps which are invaluable.\nThis guide is laid out in the following order:\n Load data into Genome Studio Clustering within Genome Studio QC of Haploid SNPs QC of Autosomal SNPs Final Quality Thresholds Exporting data \u0026amp; Post-QC steps  Support Files  human coreExome 24 v1.0 and v1.1 accessed 18/4/2016  References Guo, Yan, Jing He, Shilin Zhao, Hui Wu, Xue Zhong, Quanhu Sheng, David C. Samuels, Yu Shyr, and Jirong Long. \u0026ldquo;Illumina human exome genotyping array clustering and quality control.\u0026rdquo; nature protocols 9, no. 11 (2014): 2643-2662.\nIllumina (2016). Infinium Genotyping Data Analysis. [Technical Data Sheet]. Retrieved 18 January, 2016 from http://www.illumina.com/Documents/products/technotes/technote_infinium_genotyping_data_analysis.pdf\n1. Load data into Genome Studio Follow Step 1 of Guo et al. (2014).\n2. Clustering within Genome Studio Follow Steps 2 to 6 of Guo et al. (2014).\nBriefly:\n2) Auto clustering 3) Filter samples with a call-rate \u0026lt;94.5% 4) Exclude these samples - update SNP statistics 5) Unselect \u0026quot;show excluded samples\u0026quot; in the cluster graph 6) Exclude all samples with call-rate \u0026lt;98.5% and re cluster - don't update statistics  Important: Step 6 is essential. If you skip Step 6 you will end up with thousands of SNPs (which require manual fixing) with false AB clusters such as shown below.\nOur own experience suggests that these mis-called AB clusters are almost exclusively due to troublesome samples with call rate \u0026lt; 0.99. Excluding these and reclustering places the AB cluster back in the middle of the plot and avoids this problem.\n3. QC of Haploid SNPs To speed up the QC process we deviate slightly from Guo et al. (2014) for the QC of the Haploid chromosomes.\nStep 3a): In \u0026lsquo;Samples Table\u0026rsquo;, sort samples Gender and select all the Male samples. These should now be highlighted in yellow in the SNP Graph. All Female samples should be coloured according to their genotype.\nStep 3b): Follow steps 12 - 17 of Guo et al. (2014).\nNOTE: you will need to edit the PAR_SNPs.txt file. Open this file and add the following column headers: Name, PAR.\nStep 3c): QC of X Chromosome\na. Follow step 18 Guo _et al._ (2014). [Filter: CHR = X AND PAR != 1] - If you have the Male samples selected, the bright yellow points stand out really clearly. - You can then check all of the X Chromosome SNPs by ordering by ABFreq, starting at the top and rapidly scanning through the SNPs looking for yellow areas in the center of the plot. - We recommend reviewing all of the X Chromosome SNPs with an ABFreq \u0026gt; 0, though it may be possible to stop prior to this ~ ABFreq \u0026lt; 0.2. Scanning through the remainder however will only take a couple of minutes, so is worthwhile. b. Change the SNP filter of CHR = X and PAR = 1 to check all the pseudo autosomal SNPs labelled as the X chromosome. These should look similar to a normal autosomal SNP, check the clusters are well defined, if not zero the selected SNP.  Step 3d): QC of Y Chromosome\nIf you follow Guo et al. (2014), this step will take you a couple of hours. To speed this up, we suggest the following:\na. In the 'SNP Table' change the filter to [CHR = Y AND PAR != 1] OR [CHR = 0 AND Name \u0026quot;has\u0026quot; Y] b. In the 'Sample Table' select all of the Female samples. Right click and exclude these samples. **NOTE:** that you do not need to update the Sample or heritability statistics if prompted. Doing so would take quite a while, and as we are adding the females back in later, is not necessary. c. In the 'SNP Table' select all SNPs (these should only be the Y chromosome SNPs) d. Right click the selected SNPs and \u0026quot;Recluster Selected SNPs\u0026quot;. This may take a few minutes, but it will hopefully remove a large portion of poorly clustered SNPs When prompted, update the SNP statistics. e. In the 'Samples Table' select all Female samples with a call rate \u0026gt;98.5% (the ones we excluded in \u0026quot;b\u0026quot;) and \u0026quot;Include\u0026quot; these again. Once again, there is no need to update the sample and heritability statistics if prompted. f. Follow Step 19 Guo _et al._ (2014). (NB/ Guo _et al._ have a typo, sort by call freq not call rate) f. Add a new column to the SNP Table that estimates the Male Call Freq (#calls/~#men) for Y Chromosome SNPs. Double check this value is \u0026gt; 95% for all Y Chromosome SNPs. g. Change the SNP filter to CHR = Y and PAR = 1 to check all the pseudo autosomal SNPs on the Y chromosome. These should look similar to a normal autosomal SNP, check the clusters are well defined, if not zero the selected SNP.  Step 3e): Follow Step 20 \u0026amp; 21 Guo et al. (2014). (NB/ Guo et al. has a typo, mitochondria are haploid not diploid)\nNOTE: though not stated, be sure to change the filter to [CHR = MT] OR [CHR = 0 AND Name \u0026ldquo;has\u0026rdquo; MT] OR [CHR = 0 AND Name \u0026ldquo;has\u0026rdquo; Mito].\nThis is the end of the Haploid QC steps. Autosomal QC will be based on the Illumina (2016) protocol. Ignore Steps 22 - 33 of Guo et al. (2014).\n4. QC of Autosomal SNPs BaseFilter: Filter the SNP Table to exclude the X, Y, and MT chromosomes. In addition, apply a filter on Edited = 0 (i.e. only shows SNPs we have not edited). [CHR != X AND CHR != Y AND CHR != MT] AND [CHR != 0 AND Name \u0026ldquo;lacks\u0026rdquo; Y AND Name \u0026ldquo;lacks\u0026rdquo; MT AND Name \u0026ldquo;lacks\u0026rdquo; Mito] AND [Edited = 0]\nNOTE: This filter has been saved to GenomeStudio as \u0026lsquo;autosome base filter\u0026rsquo; and can be easily applied by loading it in the Filter window. It leaves SNPs on the XY chromosome as these are pseudo autosomal SNPs so should be treated similarly.\nWe will refer to this filter as the BaseFilter throughout the rest of this guide.\nStep 4a): Cluster Separation Thresholds\nHere, the objective is to identify the LOWER limit on cluster separation (the point below which \u0026ldquo;the majority of loci are unsuccessful\u0026rdquo; (Illumina, 2016, n.p.). In addition, we will aim to identify an approximate UPPER limit above which all loci are successful. Between these two limits are the SNPs we will have to review.\nsteps referred to in Illumina 2016 are referencing section \u0026ldquo;Evaluating and Editing SNP Cluster Positions\u0026rdquo;\nPart One:\n Sort by ClusterSep (descending) Rapidly scan through SNPs to identify the rough UPPER limit for ClusterSeparation. Once identified, you may adjust the filter if you like. Rapidly scan through the SNPs to identify the rough LOWER limit for ClusterSeparation. Zero all SNPs below this threshold.  Part Two:\n (optional) add LOWER \u0026lt; ClusterSep \u0026lt; UPPER to the BaseFilter Follow Step 2, Illumina (2016)  NOTE: For unambiguous SNPs you may be able to improve the CallFreq by adjusting the cluster positions. We found the following appropriate:\n- CallFreq \u0026lt; 0.93 were reliably poor. These were zeroed unless there was an obvious biological reason the low CallFreq (for example structural polymorphisms). - CallFreq \u0026gt; 0.93 were able to be reliably edited. IMPORTANT: at the end we zero all SNPs with a CallFreq \u0026lt; 0.95 \u0026amp; Edited = 0. If you move a cluster at all, the Edited flag changes from 0 to 1. Therefore, **if you try unsuccessfully to edit a SNP, you must manually ZERO it**.  This is the most subjective step. It is tempting to keep SNPs with CallFreq ~ 0.94 after you have manually edited. However, we recommend that you try to be as impartial as possible here. if you edit a SNP and cannot get the Call Freq \u0026gt; 0.95, then zero it and move on.\nStep 4b): Reset filter to BaseFilter then follow Step 3, Illumina (2016).\nIn addition to Illumina (2016), Table 1 suggests a hard limit: AB R Mean \u0026lt; 0.2 should be zeroed. Regardless of cluster definition, AB R Mean \u0026lt; 0.2 suggests problems with the detection of these SNPs.\nEdit: Filter out SNPs with AB Freq = 0 before performing this step.\nStep 4c): Reset filter to BaseFilter then follow Step 4, Illumina (2016).\nStep 4d): Reset filter to BaseFilter then follow Steps 5 \u0026amp; 6, Illumina (2016) if you have family/relatedness information for your data. If you don\u0026rsquo;t have this info these QC steps can be performed outside Genome Studio.\nStep 4e): Reset filter to BaseFilter then follow Step 7, Illumina (2016)\nStep 4f): Detect False Homozygotes (replaces Step 8, Illumina (2016))\n- To the BaseFilter add: ABFreq = 0 - Sort SNPs by MinorFreq (ascending) - Review SNPs with MinorFreq \u0026lt; 0.05 - 0.1. \u0026quot;A SNP can be edited unless clusters overlap or cannot be separated unambiguously\u0026quot; (Illumina, 2016, n.p.).  Step 4g): Hard Filters on Monomorphic SNPs.\nTable 1 (Illumina (2016)) suggests the following hard filters on Theta values. These thresholds are indicative of detection errors and therefore, of SNPs which cannot be trusted.\n- Reset filter to the BaseFilter then: remove edited = 0, add AAFreq = 1 \u0026amp; AA T Mean \u0026gt; 0.3. Zero these SNPs. - Reset filter to the BaseFilter then: remove edited = 0, add AAFreq = 1 \u0026amp; AA T Dev \u0026gt; 0.06. Zero these SNPs. - Reset filter to the BaseFilter then: remove edited = 0, add BBFreq = 1 \u0026amp; BB T Mean \u0026lt; 0.7. Zero these SNPs. - Reset filter to the BaseFilter then: remove edited = 0, add BBFreq = 1 \u0026amp; BB T Dev \u0026gt; 0.06. Zero these SNPs.  5. Final Quality Thresholds In Step 2 we removed all samples with a Call Rate \u0026lt; 0.99. We will now add all of the samples back in and recalculate the sample / SNP statistics.\nStep 5a): Remove all SNP filters. In the \u0026lsquo;Samples Table\u0026rsquo; select all samples and include these. When prompted, recalculate the sample statistics and sample heritability (this may take a little while depending on the number of samples).\nStep 5b): In the \u0026lsquo;Sample Table\u0026rsquo; sort by Call Rate (ascending). Exclude all samples with a Call Rate \u0026lt; 0.98.\nStep 5c): Final check of SNP CallFreq (make sure no SNP filters are on)\n- Filter all SNPs with CallFreq \u0026lt; 0.95. - Review these SNPs, manually editing where possible.  Step 5d): Hard limit on CallFreq\n- Filter: CallFreq \u0026lt; 0.95 \u0026amp; Chromosome != Y. - Zero these SNPs. - Estimate what a CallFreq \u0026lt; 0.95 for men only would look like in the full group (eg. 2734 men in a group of 4053 people would give a CallFreq of 0.64 in the whole group for a Y chromosome SNP with a CallFreq of 0.95 in men only [2734 * 0.95 /4053]) - Filter: CallFreq \u0026lt; calculated number (eg 0.64) \u0026amp; Chromosome = Y. - Zero these SNPs.  Step 5e): Save the project.\n6. Exporting data \u0026amp; Post-QC steps Follow Steps 34 onwards, Guo et al. (2014).\n","description":"","id":4,"section":"docs","tags":["GenomeStudio"],"title":"Genome Studio QC","uri":"https://merrimanlab.github.io/docs/genome-studio-qc/"}]